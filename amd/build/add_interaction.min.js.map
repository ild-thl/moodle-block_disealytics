{"version":3,"file":"add_interaction.min.js","sources":["../src/add_interaction.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Adds interactivity to view-templates and the main-template\n *\n * @module      block_disealytics/add_interaction\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport ModalFactory from 'core/modal_factory';\nimport Templates from 'core/templates';\nimport {\n    getCourseId,\n    getViewlist,\n    setScrollTo,\n    setScrollToElement,\n    setViewlist,\n    updateViewlist\n} from 'block_disealytics/view_selection';\nimport {anyViewsEnabled, updateView} from 'block_disealytics/update_view';\n\n/**\n * Initializes the view functionality with the specified viewname.\n * Calls registerEventListener.\n *\n * @param {string} viewname - The viewname in the format of 'viewname-view'.\n * @returns {void}\n */\nexport const init = (viewname) => {\n    registerEventListener(viewname);\n    if (!anyViewsEnabled()) {\n        const infoOnViews = document.querySelector('.show-when-no-view-exists');\n        if (infoOnViews) {\n            // Remove the 'hidden' class to show the message.\n            infoOnViews.classList.remove('hidden');\n        }\n    }\n    moveModalsToBodyEnd(viewname);\n};\n\n/**\n * Creates a container for modals and inserts it before the closing body tag.\n * Modals are moved into the container if they have the class 'block_disealytics-main-modal'.\n * @returns {void}\n */\nexport const createModalsContainer = () => {\n    // Create a div to contain all modals.\n    const modalsContainer = document.createElement('div');\n    modalsContainer.classList.add('block_disealytics');\n    modalsContainer.classList.add('block_disealytics-modals');\n    // Get the reference to the closing body tag.\n    const closingBodyTag = document.body.lastElementChild;\n    // Insert the container before the closing body tag.\n    document.body.insertBefore(modalsContainer, closingBodyTag);\n    const mainModals = document.querySelectorAll('.block_disealytics-main-modal');\n    if (mainModals && mainModals.length > 0) {\n        mainModals.forEach((modal) => {\n            modalsContainer.appendChild(modal);\n        });\n    }\n};\n\n/**\n * Moves specific modals with the given viewname into the modals container at the end of the body.\n * @param {string} viewname - The identifier for the modals.\n * @returns {void}\n */\nexport const moveModalsToBodyEnd = (viewname) => {\n    const infoModal = document.getElementById(`${viewname}-info-modal`);\n    const removeModal = document.getElementById(`${viewname}-remove-modal`);\n    const configModals = document.querySelectorAll(`.${viewname}-config-modal`);\n    const plannerModals = document.querySelectorAll('.block_disealytics-planner-event-modal');\n    const modalsContainer = document.querySelector('.block_disealytics-modals');\n\n    if (modalsContainer) {\n        if (infoModal) {\n            modalsContainer.appendChild(infoModal);\n        }\n        if (removeModal) {\n            modalsContainer.appendChild(removeModal);\n        }\n        if (plannerModals && plannerModals.length > 0) {\n            plannerModals.forEach((modal) => {\n                modalsContainer.appendChild(modal);\n            });\n        }\n        if (configModals && configModals.length > 0) {\n            configModals.forEach((modal) => {\n                modalsContainer.appendChild(modal);\n            });\n        }\n    }\n};\n\n/**\n * Deletes modals within the modals container, excluding those with the class 'block_disealytics-main-modal'.\n * @returns {void}\n */\nexport const deleteModalsContainer = () => {\n    const modalsContainer = document.querySelector('.block_disealytics-modals');\n    Array.from(modalsContainer.children).forEach((child) => {\n        if (!child.classList.contains('block_disealytics-main-modal')) {\n            child.remove();\n        }\n    });\n};\n\n/**\n * Create a custom modal using a template.\n *\n * @param {string} linkToTemplate - The link to the template.\n * @param {Promise} title - The title of the modal.\n * @param {number} id - The ID parameter for the template.\n * @returns {Promise<object>} - A promise that resolves to the created modal.\n */\nexport const createDiseaModal = async(linkToTemplate, title, id) => {\n    return await ModalFactory.create({\n        title: title,\n        body: Templates.render(linkToTemplate, {id: id}),\n        removeOnClose: true\n    });\n};\n\n/**\n * Show a modal.\n *\n * @param {object} modal - The modal to show.\n */\nexport const showDiseaModal = async(modal) => {\n    const modalObj = await modal;\n    modalObj.show();\n};\n\n/**\n * Hide a modal.\n *\n * @param {object} modal - The modal to hide.\n */\nexport const hideDiseaModal = async(modal) => {\n    const modalObj = await modal;\n    modalObj.hide();\n};\n\n/**\n * Sets up the editing mode functionality.\n * Adds event listeners to the toggle button, drag and drop functionality,\n * and add view buttons for each view in the editing mode.\n * When the toggle button is clicked, it triggers the \"editing\" mode update,\n * and sets up drag and drop functionality for view reordering.\n * When add view button is clicked, it adds the view to the dashboard and saves the updated view list.\n *\n * Is called in the javascript of the main.mustache template.\n *\n * @function\n * @returns {void}\n */\nexport const setEditingMode = () => {\n    const exitEditing = document.querySelector('#block_disealytics_main_exit-edit_button');\n    if (exitEditing) {\n        exitEditing.addEventListener(\"click\", function() {\n            updateSetting('toggle', 'editing');\n        });\n    }\n    const toggleButton = document.querySelector('.block_disealytics-toggle-editing');\n    if (toggleButton) {\n        toggleButton.addEventListener(\"click\", function() {\n            updateSetting('toggle', 'editing');\n            const dropContainer = document.querySelector(\".block_disealytics-drop-container\");\n            getViewlist().forEach(({viewname}) => {\n                const viewContainer = document.querySelector('#block_disealytics-' + viewname);\n                // Set up drag and drop functionality.\n                viewContainer.addEventListener(\"dragstart\", () => {\n                    viewContainer.classList.add(\"dragging\");\n                });\n                viewContainer.addEventListener(\"dragend\", () => {\n                    viewContainer.classList.remove(\"dragging\");\n                    // Save the new order in the database.\n                    const allViewsContainer = document.querySelector(\".block_disealytics-all-views-container\");\n                    const viewElements = [...allViewsContainer.children];\n                    const updatedViews = [];\n                    viewElements.forEach(viewElement => {\n                        const viewname = viewElement.id.replace(/^block_disealytics-/, '');\n                        if (viewElement.textContent.trim() !== '') {\n                            const newView = {viewname: viewname, enabled: 1};\n                            updatedViews.push(newView);\n                        } else {\n                            const newView = {viewname: viewname, enabled: 0};\n                            updatedViews.push(newView);\n                        }\n                    });\n                    updateSetting('write', 'views', JSON.stringify(updatedViews));\n                });\n                // Show/Hide edit-buttons on views.\n                const editBtn = document.querySelector('.edit-button-' + viewname);\n                if (editBtn) {\n                    if (!editBtn.classList.contains('hidden')) {\n                        editBtn.classList.add('hidden');\n                    } else {\n                        editBtn.classList.remove('hidden');\n                    }\n                }\n            });\n            dropContainer.addEventListener(\"dragover\", (e) => {\n                e.preventDefault();\n                const afterElement = getDragAfterElement(dropContainer, e.clientY);\n                const draggable = document.querySelector('.dragging');\n                if (afterElement === null) {\n                    dropContainer.appendChild(draggable);\n                } else {\n                    dropContainer.insertBefore(draggable, afterElement);\n                }\n            });\n            if (!anyViewsEnabled()) {\n                const infoOnViews = document.querySelector('.show-when-no-view-exists');\n                if (infoOnViews) {\n                    // Remove the 'hidden' class to show the message.\n                    infoOnViews.classList.remove('hidden');\n                }\n            }\n\n        }, true);\n    }\n\n    // Add EventListeners to the Buttons.\n    getViewlist().forEach(({viewname, enabled}) => {\n        // Check if the view is disabled\n        // Add view button.\n        const addButton = document.querySelector('.block_disealytics-add-' + viewname);\n        const viewContainer = document.querySelector('#block_disealytics-' + viewname);\n        if (addButton) {\n            if (enabled === 1) {\n                addButton.classList.add('hidden');\n            }\n            addButton.addEventListener(\"click\", function() {\n                document.querySelector('.show-when-no-view-exists').classList.add('hidden');\n                addButton.classList.add('hidden');\n                viewContainer.parentElement.append(viewContainer);\n                viewContainer.setAttribute('data-visible', 'true');\n                setScrollToElement('block_disealytics-' + viewname);\n                setScrollTo(true);\n                const updatedViewList = updateViewlist(viewname, 'add');\n                updateSetting('write', 'views', JSON.stringify(updatedViewList));\n            }, true);\n        }\n    });\n};\n\n/**\n * Get the element after which the dragged element should be inserted within a container.\n * The function finds the closest element based on the vertical position (y-coordinate).\n *\n * @param {HTMLElement} container - The container element containing draggable elements.\n * @param {number} y - The vertical position (y-coordinate) of the dragged element.\n * @returns {HTMLElement} The element after which the dragged element should be inserted.\n */\nconst getDragAfterElement = (container, y) => {\n    // Get an array of draggable elements within the container (excluding the currently dragging element).\n    const draggableElements = [...container.querySelectorAll('.draggable:not(.dragging)')];\n    // Use the `reduce` function to find the closest element based on the vertical position (y-coordinate).\n    return draggableElements.reduce((closest, child) => {\n        // Calculate the offset from the vertical center of each element to the dragged element's position.\n        const box = child.getBoundingClientRect();\n        const offset = y - box.top - box.height / 2;\n\n        // Update the closest element if the current offset is negative (above the dragged element) and\n        // closer to the dragged element than the previous closest element.\n        if (offset < 0 && offset > closest.offset) {\n            return {offset: offset, element: child};\n        } else {\n            return closest;\n        }\n    }, {offset: Number.NEGATIVE_INFINITY}).element;\n};\n\n/**\n * Registers event listeners (for a single view) that change the user preferences.\n *\n * @param {string} viewname - The viewname in the format of 'viewname-view'.\n * @returns {void}\n */\nconst registerEventListener = (viewname) => {\n    // Returns every delete button.\n    const deleteButtons = document.querySelectorAll('.block_disealytics-delete-btn-' + viewname);\n    const addButton = document.querySelector('.block_disealytics-add-' + viewname);\n    const viewContainer = document.querySelector('#block_disealytics-' + viewname);\n    if (deleteButtons) {\n        [].forEach.call(deleteButtons, (deleteButton) => {\n            // Event to remove the view.\n            deleteButton.addEventListener(\"click\", function() {\n                viewContainer.setAttribute('data-visible', 'false');\n                addButton.classList.remove('hidden');\n                const updatedViewList = updateViewlist(viewname, 'delete');\n                updateSetting('write', 'views', JSON.stringify(updatedViewList));\n            }, false);\n        });\n    }\n    // Returns every toggle button.\n    const toggleExpansionButtons = document.querySelectorAll('.block_disealytics-toggle-expansion-btn-' + viewname);\n    [].forEach.call(toggleExpansionButtons, (e) => {\n        e.addEventListener(\"click\", function() {\n            setScrollTo(true);\n            updateSetting(\"write\", 'expanded_view', viewname);\n        }, false);\n    });\n    toggleInformationModal(viewname);\n    setCourseCategory(viewname);\n    toggleViewmodeAccordion(viewname);\n};\n\n/**\n * Calculates the position for the information window.\n *\n * Is called in the javascript of the main.mustache template and in the registerEventListener function.\n *\n * @param {string} viewname - The viewname in the format of 'viewname-view'.\n * @returns {void}\n */\nexport const toggleInformationModal = (viewname) => {\n    const informationButton = document.querySelector('.info-btn-' + viewname);\n    const outerWindow = document.querySelector('.outer-modal-' + viewname);\n\n    if (informationButton && outerWindow) {\n        informationButton.addEventListener(\"click\", function() {\n            // Toggle the 'show' class to display or hide the popup.\n            outerWindow.classList.toggle('show');\n        });\n    }\n};\n\nexport const changeToggleIcon = () => {\n    const toggleLink = document.querySelector('#block_disealytics_config_consent_menu');\n    const toggleIcon = toggleLink.querySelector('i');\n\n    if (toggleLink && toggleIcon) {\n        toggleLink.addEventListener(\"click\", function() {\n            toggleIcon.classList.remove('disea-green');\n            toggleIcon.classList.remove('fa-toggle-on');\n            toggleIcon.classList.add('disea-gray');\n            toggleIcon.classList.add('fa-toggle-off');\n\n            // Set a timeout to change the classes back after 1 second.\n            setTimeout(function() {\n                toggleIcon.classList.remove('disea-gray');\n                toggleIcon.classList.remove('fa-toggle-off');\n                toggleIcon.classList.add('disea-green');\n                toggleIcon.classList.add('fa-toggle-on');\n            }, 1000);\n        });\n    }\n};\n\n/**\n * Toggles the visibility of an accordion content section and updates the toggle icon.\n *\n * @param {HTMLElement} element - The head element that surrounds the toggle function.\n * @param {number} index - The index of the accordion section to toggle.\n * @returns {void}\n */\nexport function toggleAccordion(element, index) {\n    const content = element.querySelector(`#content-${index}`);\n    const icon = element.querySelector(`#icon-${index}`);\n\n    if (content.classList.contains('active')) {\n        // Fold the content if it's open.\n        content.classList.remove('active');\n        icon.className = \"fa fa-chevron-down accordion-icon\";\n    } else {\n        // Unfold the content if it's closed.\n        content.classList.add('active');\n        icon.className = \"fa fa-chevron-up accordion-icon\";\n    }\n}\n\n/**\n * Retrieves the trimmed value of an HTML element by its ID.\n *\n * @function\n * @name getValueById\n * @param {string} id - The ID of the HTML element.\n * @returns {string} - The trimmed value of the specified element.\n */\nexport function getValueById(id) {\n    return document.getElementById(id).value.trim();\n}\n\n/**\n * Makes an AJAX call to change a user preference, then calls a view update.\n *\n * @param {string} updatetype - The type of update to perform (set, toggle, expand).\n * @param {string} setting - Determines which and how a user preference should be changed.\n * @param {string} val tmp.\n * @returns {void}\n */\nexport const updateSetting = (updatetype, setting, val = undefined) => {\n    let args = {\n        info: {\n            action: updatetype,\n            name: setting,\n        }\n    };\n    if (val !== undefined) {\n        args.info.value = val;\n    }\n    Ajax.call([{\n        methodname: 'block_disealytics_write_user_preference',\n        args,\n    }\n    ])[0].done(async function(response) {\n        // Remove contents of the modal container.\n        await deleteModalsContainer();\n        if (setting === 'viewmode' || setting === 'editing') {\n            let views = getViewlist().filter((e) => e.enabled === 1).map((e) => e.viewname);\n            await updateView(getCourseId(), views);\n        } else {\n            if (setting === 'views') {\n                const data = JSON.parse(response);\n                setViewlist(JSON.parse(data.setting));\n                await updateView(getCourseId(), getViewlist());\n            } else if (setting === 'expanded_view') {\n                await updateView(getCourseId(), [val]);\n            } else {\n                await updateView(getCourseId(), undefined);\n            }\n        }\n        if (updatetype === 'select_category') {\n            await updateView(getCourseId(), [setting]);\n        }\n        if (updatetype === \"revoke_consent\") {\n            location.reload();\n        }\n    }).fail(function(err) {\n        window.console.log(err);\n    });\n};\n\n/**\n * Adds an EventListener to the viewmode dropdown.\n *\n * @returns {void}\n */\nexport const enableViewmodeDropdown = () => {\n    document.querySelector(\".main-viewmode-selection\").addEventListener(\"change\", function() {\n        let select = document.querySelector(\".main-viewmode-selection\");\n        const viewmodeLabel = document.querySelector(\".main-viewmode-label\");\n        if (viewmodeLabel) {\n            updateSetting(\"write\", 'viewmode', select.value);\n        }\n    });\n};\n\n/**\n * Adds an EventListener to the consent buttons.\n *\n * @returns {void}\n */\nexport const enableConsentButtons = () => {\n    document.querySelector(\".disea-delete-btn\").addEventListener(\"click\", function() {\n        updateSetting(\"revoke_consent\", '', \"delete\");\n    });\n    document.querySelector(\".disea-save-btn\").addEventListener(\"click\", function() {\n        updateSetting(\"revoke_consent\", '', '');\n    });\n};\n\n\nexport const setCourseCategory = (viewname) => {\n    const courseCategories = document.querySelectorAll(\".course-category-global-item-\" + viewname);\n\n    courseCategories.forEach(category => {\n        category.addEventListener(\"click\", function() {\n            const selectedCategory = this.textContent.trim();\n            updateSetting(\"select_category\", viewname, selectedCategory);\n        });\n    });\n};\n\nexport const toggleViewmodeAccordion = (viewname) => {\n    const accordionIcons = document.querySelectorAll('.course-category-icon-' + viewname);\n\n    accordionIcons.forEach(icon => {\n        if (icon) {\n            const container = icon.closest('.accordion-head-course-category-' + viewname);\n            if (container) {\n                icon.addEventListener('click', (event) => {\n                    event.stopPropagation(); // Prevent the click from reaching the container\n                    icon.classList.toggle('fa-chevron-down');\n                    icon.classList.toggle('fa-chevron-up');\n\n                    const panelBody = container.nextElementSibling;\n                    panelBody.classList.toggle('hidden');\n                });\n                container.addEventListener('click', () => {\n                    // Handle the click on the container (excluding the icon)\n                    icon.classList.toggle('fa-chevron-down');\n                    icon.classList.toggle('fa-chevron-up');\n\n                    const panelBody = container.nextElementSibling;\n                    panelBody.classList.toggle('hidden');\n                });\n            }\n        }\n    });\n};\n\nexport const toggleAccordionAV = (icon) => {\n    const coursename = icon.dataset.coursename;\n    const table = document.querySelector(`.table-of-assignments[data-coursename=\"${coursename}\"]`);\n\n\n    if (icon.classList.contains('active')) {\n        // Fold the content if it's open.\n        icon.classList.remove('active');\n        icon.classList.replace('fa-chevron-up', 'fa-chevron-down');\n        table.classList.remove('hidden');\n    } else {\n        // Unfold the content if it's closed.\n        icon.classList.add('active');\n        icon.classList.replace('fa-chevron-down', 'fa-chevron-up');\n        table.classList.add('hidden');\n    }\n};\n\n"],"names":["id","document","getElementById","value","trim","element","index","content","querySelector","icon","classList","contains","remove","className","add","viewname","registerEventListener","infoOnViews","moveModalsToBodyEnd","modalsContainer","createElement","closingBodyTag","body","lastElementChild","insertBefore","mainModals","querySelectorAll","length","forEach","modal","appendChild","infoModal","removeModal","configModals","plannerModals","deleteModalsContainer","Array","from","children","child","async","linkToTemplate","title","ModalFactory","create","Templates","render","removeOnClose","show","hide","exitEditing","addEventListener","updateSetting","toggleButton","dropContainer","_ref","viewContainer","viewElements","updatedViews","viewElement","replace","textContent","newView","enabled","push","JSON","stringify","editBtn","e","preventDefault","afterElement","getDragAfterElement","clientY","draggable","_ref2","addButton","parentElement","append","setAttribute","updatedViewList","container","y","reduce","closest","box","getBoundingClientRect","offset","top","height","Number","NEGATIVE_INFINITY","deleteButtons","call","deleteButton","toggleExpansionButtons","toggleInformationModal","setCourseCategory","toggleViewmodeAccordion","informationButton","outerWindow","toggle","toggleLink","toggleIcon","setTimeout","updatetype","setting","val","undefined","args","info","action","name","methodname","done","response","views","filter","map","data","parse","location","reload","fail","err","window","console","log","select","category","selectedCategory","this","event","stopPropagation","nextElementSibling","coursename","dataset","table"],"mappings":"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"}